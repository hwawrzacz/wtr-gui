<h1 mat-dialog-title>Create user</h1>

<mat-dialog-content>
  <form [formGroup]="form" class="personal-details">
    <h3>Credentials</h3>
    <section class="credentials__wrapper">
      <div class="credentials__inputs">
        <mat-form-field appearance="outline">
          <mat-label>Login</mat-label>
          <input matInput formControlName="login" />
          <mat-error *ngIf="hasError('login')">{{ getErrorMessage('login') }}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>New password</mat-label>
          <input matInput type="password" formControlName="password" />
          <mat-error *ngIf="hasError('repeatPassword')">{{ getErrorMessage('password') }}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Repeat passwrod</mat-label>
          <input matInput type="password" formControlName="repeatPassword" />
          <mat-error *ngIf="hasError('repeatPassword')">{{ getErrorMessage('repeatPassword') }}
          </mat-error>
        </mat-form-field>
      </div>

      <div class="credentials__image">
        <figure>
          <img src="{{ faceImageUrl }}" />
        </figure>

        <div class="fx-center">
          <button mat-button color="primary" (click)="openImageCaptureDialog()">
            <mat-icon>add_a_photo</mat-icon>
            <span>Update face image</span>
          </button>
        </div>

        <app-image-uploader (imageChanged)="setImagePreview($event)"></app-image-uploader>
      </div>
    </section>

    <h3>Personal details</h3>
    <section>
      <mat-form-field appearance="outline">
        <mat-label>First name</mat-label>
        <input matInput formControlName="firstName" />
        <mat-error *ngIf="hasError('firstName')">{{ getErrorMessage('firstName') }}</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Last name</mat-label>
        <input matInput formControlName="lastName" />
        <mat-error *ngIf="hasError('lastName')">{{ getErrorMessage('lastName') }}</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Phone number</mat-label>
        <input matInput formControlName="phoneNumber" />
        <mat-error *ngIf="hasError('phoneNumber')">{{ getErrorMessage('phoneNumber') }}</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Email</mat-label>
        <input matInput formControlName="email" />
        <mat-error *ngIf="hasError('email')">{{ getErrorMessage('email') }}</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Position</mat-label>
        <mat-select formControlName="role">
          <mat-option *ngFor="let role of positionsList" [value]="role"> {{ getPositionString(role) }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="hasError('role')">{{ getErrorMessage('role') }}</mat-error>
      </mat-form-field>
    </section>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-raised-button color="primary" [disabled]="!form.valid || isLoading" (click)="onSave()">
    <mat-spinner [diameter]="20" *ngIf="isLoading"></mat-spinner>
    <span>Create</span>
  </button>
  <button mat-button [disabled]="isLoading" (click)="closeDialog()">Cancel</button>
</mat-dialog-actions>